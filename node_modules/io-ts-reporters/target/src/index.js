"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var array = require("fp-ts/lib/Array");
var Either_1 = require("fp-ts/lib/Either");
var Option_1 = require("fp-ts/lib/Option");
var pipeable_1 = require("fp-ts/lib/pipeable");
var jsToString = function (value) { return (value === undefined ? 'undefined' : JSON.stringify(value)); };
exports.formatValidationError = function (error) {
    var path = error.context
        .map(function (c) { return c.key; })
        // The context entry with an empty key is the original type ("default
        // context"), not an type error.
        .filter(function (key) { return key.length > 0; })
        .join('.');
    // The actual error is last in context
    var maybeErrorContext = array.last(
    // https://github.com/gcanti/fp-ts/pull/544/files
    error.context);
    return pipeable_1.pipe(maybeErrorContext, Option_1.map(function (errorContext) {
        var expectedType = errorContext.type.name;
        return (
        // https://github.com/elm-lang/core/blob/18c9e84e975ed22649888bfad15d1efdb0128ab2/src/Native/Json.js#L199
        // tslint:disable-next-line:prefer-template
        "Expecting " + expectedType
            + (path === '' ? '' : " at " + path)
            + (" but instead got: " + jsToString(error.value) + "."));
    }));
};
exports.reporter = function (validation) { return (pipeable_1.pipe(validation, Either_1.fold(function (errors) { return array.compact(errors.map(exports.formatValidationError)); }, function () { return []; }))); };
//# sourceMappingURL=index.js.map